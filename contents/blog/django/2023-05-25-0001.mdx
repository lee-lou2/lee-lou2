---
title: 'Full Text Search ì„¤ì •/ì‚¬ìš©'
authors: [jake]
tags: [django, orm, full-text-search]
---

## â­ ì°¸ê³  ì‚¬í•­

| ë‚´ìš© |
| --- |
| 'ì„¤ì •' ë¶€ë¶„ì€ mysql ì— ëŒ€í•œ ì ìš© ì‚¬í•­ì…ë‹ˆë‹¤ (Postgres ëŠ” í´ë˜ìŠ¤ë¥¼ ì •ì˜í•˜ì§€ ì•Šì•„ë„ ë°”ë¡œ ì‚¬ìš©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤) |
| â€¢ FULL TEXT Search ì— ì‚¬ìš©ë˜ëŠ” ì¿¼ë¦¬ëŠ”Â select * from table match (col) against ('text*' in boolean mode)Â ì…ë‹ˆë‹¤ |
| â€¢ í•´ë‹¹ í…Œì´ë¸”ì˜ ì»¬ëŸ¼ì— FULL TEXT ê°€ ì ìš©ë˜ì–´ìˆì–´ì•¼í•©ë‹ˆë‹¤ |


## ğŸ¥ ì„¤ì • ë°©ë²•

```python
from django.db import models

class SearchLookUp(models.Lookup):
    """FULL TEXT ê²€ìƒ‰ í´ë˜ìŠ¤"""
    lookup_name = "search"

    def as_mysql(self, compiler, connection):
        lhs, lhs_params = self.process_lhs(compiler, connection)
        rhs, rhs_params = self.process_rhs(compiler, connection)
        params = lhs_params + rhs_params
        return "MATCH (%s) AGAINST (%s IN BOOLEAN MODE)" % \
               (lhs, rhs), list(map(lambda x: f"{x}*", params))

# í•„ë“œë³„ ì ìš© - ì—¬ê¸°ì—ì„œ ì •ì˜í•œ í•„ë“œì— ëŒ€í•´ì„œë§Œ search ê²€ìƒ‰ì´ ê°€ëŠ¥
models.CharField.register_lookup(SearchLookUp)
models.TextField.register_lookup(SearchLookUp)
```

## ğŸ¥ ì‚¬ìš© ë°©ë²•

```python
SampleTable.objects.filter(name__search="ì¥")
# ê²°ê³¼ : ì¥ìŠ¹êµ­, ì¥... ë“± ê´€ë ¨ í…ìŠ¤íŠ¸ê°€ ê²€ìƒ‰ë©ë‹ˆë‹¤
# __search ë¥¼ ì¶”ê°€í•˜ë©´ FULL TEXT ê²€ìƒ‰ì´ ê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤
```